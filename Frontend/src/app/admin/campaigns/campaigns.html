<div class="container mt-4">

  <!-- Uyarı mesajı -->
  <div *ngIf="message" class="alert alert-info text-center">
    {{ message }}
  </div>

  <!-- Kampanya Ekle / Güncelle Butonu -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">Kampanyalar</h4>
    <button class="btn btn-primary" (click)="toggleForm()">
      {{ showForm ? 'Formu Kapat' : (editingId ? 'Güncelle' : 'Yeni Kampanya Ekle') }}
    </button>
  </div>

  <!-- Form -->
  <div *ngIf="showForm" class="card mb-4 shadow-sm">
    <div class="card-body">
      <form [formGroup]="campaignForm" (ngSubmit)="submitForm()">
        <div class="row g-3">
        <div class="col-md-3">
  <label class="form-label">Kredi Tipi</label>
  <select class="form-select" formControlName="creditType">
  <option [ngValue]="null">Kredi Tipi Seçiniz</option>
  <option *ngFor="let c of creditTypes" [ngValue]="c.value">
    {{ c.label }}
  </option>
</select>

</div>

          <div class="col-md-3">
            <label class="form-label">Min Vade</label>
            <input type="number" class="form-control" formControlName="minVade" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Max Vade</label>
            <input type="number" class="form-control" formControlName="maxVade" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Faiz Oranı (%)</label>
            <input type="number" step="0.01" class="form-control" formControlName="faizOrani" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Min Kredi Tutarı</label>
            <input type="number" class="form-control" formControlName="minKrediTutar" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Max Kredi Tutarı</label>
            <input type="number" class="form-control" formControlName="maxKrediTutar" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Başlangıç Tarihi</label>
          <input type="date" class="form-control" formControlName="baslangicTarihi" [min]="today" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Bitiş Tarihi</label>
            <input type="date" class="form-control" formControlName="bitisTarihi" [min]="today" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Açıklama</label>
            <input type="text" class="form-control" formControlName="description" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Banka ID</label>
            <input type="number" class="form-control" formControlName="bankId" />
          </div>
        </div>

        <div class="mt-3 d-flex justify-content-between">
          <button class="btn btn-success" type="submit" [disabled]="campaignForm.invalid">
            {{ editingId ? 'Güncelle' : 'Ekle' }}
          </button>
          <button class="btn btn-secondary" type="button" (click)="cancelEdit()">İptal</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Kampanya Listesi -->
  <div class="card shadow-sm">
    <div class="card-header bg-secondary text-white">
      <strong>Kayıtlı Kampanyalar</strong>
    </div>
    <div class="table-responsive">
      <table class="table table-bordered table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Sıra</th>
           <th>Kampanya Id</th>
            <th>Kredi Tipi</th>
            <th>Vade (Min-Max)</th>
            <th>Kredi (Min-Max)</th>
            <th>Faiz</th>
            <th>Tarih (Başlangıç - Bitiş)</th>
            <th>Banka ID</th>
            <th>Açıklama</th>
            <th class="text-center">İşlemler</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of campaigns; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{c.id}}</td>
            <td>{{ c.creditType }}</td>
            <td>{{ c.minVade }} - {{ c.maxVade }}</td>
            <td>{{ c.minKrediTutar }}₺ - {{ c.maxKrediTutar }}₺</td>
            <td>%{{ c.faizOrani }}</td>
            <td>{{ c.baslangicTarihi }} - {{ c.bitisTarihi }}</td>
            <td>{{ c.bankId }}</td>
           <td class="description">{{ c.description }}</td>
<td class="actions text-center">
  <button class="btn btn-sm btn-warning me-2" (click)="edit(c)">Düzenle</button>
  <button class="btn btn-sm btn-danger" (click)="delete(c.id)">Sil</button>
</td>

          </tr>
          <tr *ngIf="campaigns.length === 0">
            <td colspan="9" class="text-center text-muted">Hiç kampanya bulunamadı.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
